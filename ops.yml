dependencies:
  brew:
    - overmind
  custom:
    - bundle config --local path vendor/bundle
    - bundle
    - ops deps start
    - yarn
  apt:
    - ruby-poppler
forwards:
  deps: deps
actions:
  server:
    command: overmind start -f Procfile.dev
    load_secrets: true
  rails:
    command: bin/rails
    load_secrets: true
  build:
    command: docker compose build
    load_secrets: true
  rebuild:
    command: docker compose up --build -d
    load_secrets: true
  container:
    command: docker compose up
    load_secrets: true
  shell:
    command: docker compose exec archyve bash
    alias: sh
  with_secrets:
    command: " "
    load_secrets: true
    shell_expansion: true
  request:
    param_expansion: true
    command: >
      curl -v localhost:3300/$1 \
        -H "Accept: application/json" \
        -H "Authorization: Bearer $DEFAULT_API_KEY" \
        -H "X-Client-id: $DEFAULT_CLIENT_ID" | jq
    load_secrets: true
options:
  exec:
    load_secrets: true
